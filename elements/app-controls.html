<!--
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="app-icons.html">
<dom-module id="app-controls">
  <template strip-whitespace>
    <style>
      :host {
        display: flex;
      }
      button {
        background-color: transparent;
        color: white;
        border: none;
        cursor: pointer;
        transition: all .05s ease-in;
      }
      button[disabled] {
        opacity: 0.3;
        pointer-events: none;
      }
      button:hover {
        transform: scale(1.1);
      }
      .separator {
        border-left: var(--light-grey) solid 1px;
        opacity: .8;
        height: 24px;
        margin: 8px;
      }
    </style>
    <button on-click="undo" id="undoBtn" disabled title="Undo">
      <iron-icon icon="designer:undo"></iron-icon>
      <div>Undo</div>
    </button>
    <button on-click="redo" id="redoBtn" disabled title="Redo">
      <iron-icon icon="designer:redo"></iron-icon>
      <div>Redo</div>
    </button>
    <div class="separator"></div>
    <button on-click="jsFiddleIt" title="Create a JSFiddle">
      <iron-icon icon="designer:cloud"></iron-icon>
      <div>JSFiddle</div>
    </button>
    <form id="jsFiddleForm" hidden method='post'
          action='https://jsfiddle.net/api/post/library/pure/' target='check'>
      <input type='submit'/>
      <textarea name='html'></textarea>
      <input name='title'/>
      <input name='description'>
    </form>
  </template>
  <script>
    class AppControls extends Polymer.Element {
      static get is() { return 'app-controls'; }
      static get properties() { return {
          actionHistory: Object
        }
      }
      update(undos, redos) {
        this.$.undoBtn.disabled = (undos === 0);
        this.$.redoBtn.disabled = (redos === 0);
      }
      undo() {
        this.actionHistory.undo();
      }
      redo() {
        this.actionHistory.redo();
      }
      jsFiddleIt() {
        // TODO: investigate this.
        let code = window.codeView.get(true);
        let form = this.$.jsFiddleForm;
        form.html.value = code;
        form.title.value = 'Your sample app';
        //form.title.description = 'Autogenerated with Wizziwid';
        form.submit();
      }
    }
    customElements.define(AppControls.is, AppControls);
  </script>
</dom-module>
